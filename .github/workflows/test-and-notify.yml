name: Test and Notify

on:
  push:
    branches: [ develop ]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: 安裝依賴
        run: npm install
      - name: 執行測試
        run: npm test
      - name: 發送 Email 通知（失敗時）
        if: failure()
        uses: dawidd6/action-send-mail@v3
        with:
          server_address: smtp.gmail.com
          server_port: 465
          username: ${{ secrets.MAIL_USERNAME }}
          password: ${{ secrets.MAIL_PASSWORD }}
          subject: "🚨 測試失敗通知"
          body: "develop 分支測試失敗，請盡快檢查！"
          to: Maers_Hsu@cameo.com.tw
          from: GitHub Actions <your@email.com>
